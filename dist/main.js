(()=>{"use strict";class e{constructor(e){this.projectName=e,this.id=function(){const e=t.getProjects();let o=new Set;for(let t in e)"id"===t&&o.add(e[t]);const n=o.size;let a,c=!0;for(;c;){let e=Math.floor(1e4*Math.random()+1);if(a=o.add(e).size,n!==a)return c=!1,e}}(),this.tasks=[],this.numberOfTasks=0}}class t{static getProjects(){let e;return e=null===localStorage.getItem("projects")?[]:JSON.parse(localStorage.getItem("projects")),e}static addProject(e){const o=t.getProjects();o.push(e),localStorage.setItem("projects",JSON.stringify(o))}static updateArrayOfProjects(e){localStorage.setItem("projects",JSON.stringify(e))}static updateProjectName(e,o){e=Number.parseInt(e);const n=t.getProjects();for(let t=0;t<n.length;t++)if(n[t].id===e){n[t].projectName=o;break}localStorage.setItem("projects",JSON.stringify(n))}static updateProjectInfo(e,t){e=Number.parseInt(e);const o=this.getProjects();for(let n of o)for(const a in n)if("id"===a){if(e!==n.id)continue;{const e=o.indexOf(n);o.splice(e,1),o.push(t),this.updateArrayOfProjects(o)}}}static removeProject(e){e=Number.parseInt(e);const o=t.getProjects();for(let t=0;t<o.length;t++)if(o[t].id===e){o.splice(t,1);break}localStorage.setItem("projects",JSON.stringify(o))}static getTasks(e){e=Number.parseInt(e);const t=this.getProjects();let o;for(const n of t)for(const t in n)if("id"===t){if(e!==n.id)continue;o=n.tasks}return o}static getNumberOfTasks(e){let o;e=Number.parseInt(e);const n=t.getProjects();for(const t of n)for(const n in t)if("id"===n&&e===t.id)return o=t.numberOfTasks,o}static updateTasksArray(e,o,n){e=Number.parseInt(e);const a=t.getProjects();for(let t of a)for(const a in t)"id"===a&&e===t.id&&(t.tasks=o,"add"===n?t.numberOfTasks+=1:"remove"===n&&(t.numberOfTasks-=1),this.updateProjectInfo(e,t))}static removeTask(e,t){t=Number.parseInt(t);const o=this.getTasks(e);for(const n of o)for(const a in n)if("taskId"===a&&n[a]===t){const t=o.indexOf(n);o.splice(t,1),this.updateTasksArray(e,o,"remove")}}static updateTaskInfo(e,t,o,n,a,c){t=Number.parseInt(t);const r=this.getTasks(e);for(const s of r)for(const l in s)"taskId"===l&&s[l]===t&&(s.name=o,s.description=n,s.dueDate=a,s.priority=c,this.updateTasksArray(e,r,"edit"))}}class o{constructor(e,o,n,a,c){this.name=e,this.description=o,this.dueDate=n,this.priority=a,this.taskId=function(e){const o=t.getTasks(e);let n=new Set;for(const e of o)for(const t in e)"taskId"===t&&n.add(e.taskId);const a=n.size;let c,r=!0;for(;r;){let e=Math.floor(1e4*Math.random()+1);if(c=n.add(e).size,a!==c)return r=!1,e}}(Number.parseInt(c))}}function n(e,o){const n=document.createElement("div");n.className="main-page_project project";const a=document.createElement("div");a.className="project_title",a.textContent=e;const l=document.createElement("div");l.className="project_number-of-tasks",l.textContent=`Tasks : ${t.getNumberOfTasks(o)}`;const d=document.createElement("div");d.className="project_btns";const i=document.createElement("button");i.className="edit-btn",i.textContent="Edit";const m=document.createElement("button");m.className="remove-btn",m.textContent="Remove",d.append(i,m),i.addEventListener("click",c),m.addEventListener("click",r);const u=document.createElement("div");u.textContent=o,u.className="project-id",n.append(a,l,d,u);const p=n.querySelector(".project_btns");return n.addEventListener("mouseenter",(()=>{p.classList.add("show-project-btn"),p.style="display: block",n.classList.remove("project-to-normal"),n.classList.add("expand-project")})),n.addEventListener("mouseleave",(()=>{p.style="display: none",n.classList.add("project-to-normal"),n.classList.remove("expand-project")})),a.addEventListener("click",s),n}function a(e){document.querySelector(".main-page_row").append(e)}function c(e){const o=document.querySelector(".edit-modal-window_btn"),n=document.querySelector(".edit-modal-window"),a=e.target.parentElement.parentElement,c=a.querySelector(".project_title"),r=document.querySelector(".edit-modal-window_name-field");r.value=c.textContent,n.style="display:block",o.addEventListener("click",(()=>{c.textContent=r.value;const e=a.querySelector(".project-id").textContent;t.updateProjectName(e,r.value),n.style="display:none"}),{once:!0})}function r(e){const o=document.querySelector(".remove-modal-window"),n=e.target.parentElement.parentElement,a=n.querySelector(".project_title").textContent,c=o.querySelector(".remove-project-modal_no-btn"),r=o.querySelector(".remove-project-modal_yes-btn");o.querySelector(".remove-modal-window_title").innerHTML=`Are you sure to delete <br>"${a}" project?`,o.style="display: block",c.addEventListener("click",(()=>o.style="display: none")),r.addEventListener("click",(()=>{const e=n.querySelector(".project-id").textContent;t.removeProject(e),n.remove(),o.style="display: none"}),{once:!0})}function s(e){const o=e.target.parentElement,n=o.querySelector(".project_title").textContent,a=o.querySelector(".project-id").textContent,c=t.getTasks(a),r=document.querySelector(".project-page"),s=r.querySelector(".project-page_title"),i=r.querySelector(".project-id"),m=r.querySelectorAll(".task"),u=document.querySelector(".mobile-menu-window").querySelector(".search-input");document.querySelector(".search-input").placeholder=`Search in "${n}"`,u.placeholder=`Search in "${n}"`,s.textContent=n,i.textContent=a,m.length>0&&m.forEach((e=>e.remove())),c.forEach((e=>{d(l(e.name,e.description,e.dueDate,e.priority,e.taskId))})),document.querySelector(".main-page").style="display: none",r.style="display: block"}function l(e,t,o,n,a){let c;switch(n){case"green":c="#19de97";break;case"blue":c="#254fe7";break;case"yellow":c="#f0dc27";break;case"purple":c="#6f3ebe";break;case"red":c="#e72525"}const r=document.createElement("div");r.className="task";const s=document.createElement("div");s.className="task_upper-elements-row";const l=document.createElement("input");l.type="checkbox",l.className="task_checkbox";const d=document.createElement("div");d.className="task_title",d.textContent=e;const u=document.createElement("div");u.className="task-priority-line",u.style=`background-color: ${c};`,d.append(u);const p=document.createElement("div");p.className="task_priority-block",p.style=`background-color: ${c};`;const y=document.createElement("div");y.className="img-container";const k=document.createElement("img");k.className="expand-icon",k.src="img/expand.png",k.alt="expand-icon",y.append(k),s.append(l,d,p,y);const g=document.createElement("div");g.className="task-expanded_content-normal";const v=document.createElement("textarea");v.className="task-expanded_description",v.setAttribute("disabled","disabled"),v.textContent=t;const S=document.createElement("div");S.className="task-expanded_due-date",S.textContent=`Due: ${o}`;const f=document.createElement("div");f.className="task-expanded_btns-row";const w=document.createElement("div");w.className="task_expanded-edit-btn task-expanded_btn",w.textContent="Edit";const E=document.createElement("div");E.className="task_expanded-remove-btn task-expanded_btn",E.textContent="Remove",f.append(w,E);const b=document.createElement("span");return b.className="task_id",b.textContent=a,g.append(v,S,f),r.append(s,g,b),y.addEventListener("click",(e=>{y.classList.toggle("expand-icon-expanded"),r.classList.toggle("expanded-task"),g.classList.toggle("task-expanded_content-expanded"),s.classList.toggle("task_upper-elements-expanded"),y.addEventListener("click",(()=>{y.classList.toggle("expand-icon-normal"),r.classList.toggle("decreaseHeight")}),{once:!0})})),l.addEventListener("click",(()=>{r.classList.toggle("completed-task"),p.classList.toggle("completed-task-task-priority"),u.classList.toggle("completed-task-task-priority")})),E.addEventListener("click",i),w.addEventListener("click",m),r}function d(e){document.querySelector(".project-page_row").append(e)}function i(e){const o=document.querySelector(".project-page_remove-task-modal-window "),n=e.target.parentElement.parentElement.parentElement,a=n.querySelector(".task_id").textContent,c=n.querySelector(".task_title").textContent,r=o.querySelector(".remove-task-modal_no-btn"),s=o.querySelector(".remove-task-modal_yes-btn"),l=o.querySelector(".remove-task-modal-window_title"),d=document.querySelector(".project-page").querySelector(".project-id").textContent;o.style="display: block",l.innerHTML=`Are you sure to delete <br> "${c}" task?`,r.addEventListener("click",(()=>{o.style="display:none"}),{once:!0}),s.addEventListener("click",(()=>{n.remove(),t.removeTask(d,a),o.style="display:none"}),{once:!0})}function m(e){const o=document.querySelector(".project-page_edit-modal-window"),n=e.target.parentElement.parentElement.parentElement,a=n.parentElement.parentElement.querySelector(".project-id").textContent,c=n.querySelector(".task_id").textContent,r=n.querySelector(".task_title"),s=n.querySelector(".task-expanded_description"),l=n.querySelector(".task-expanded_due-date"),d=n.querySelector(".task_priority-block");let i=n.querySelector(".task-priority-line");null===i&&(i=document.createElement("div"),i.className="task-priority-line");const m=o.querySelector(".edit-task-modal-window_name-field");m.value=r.textContent;const u=o.querySelector(".edit-task-modal-window_task-description-input");u.value=s.value;const p=o.querySelector(".edit-task-modal_date-input"),y=o.querySelectorAll(".edit"),k=o.querySelector(".edit-task-modal-window_btn");o.style="display: block",k.addEventListener("click",(()=>{let e;y.forEach((t=>{t.checked&&(e=t.value)}));const n=m.value,k=u.value,g=p.value;let v;switch(r.textContent=n,r.append(i),s.textContent=k,l.textContent=g,e){case"green":v="#19de97";break;case"blue":v="#254fe7";break;case"yellow":v="#f0dc27";break;case"purple":v="#6f3ebe";break;case"red":v="#e72525"}d.style=`background-color: ${v} `,i.style=`background-color: ${v} `,t.updateTaskInfo(a,c,n,k,g,e),o.style="display: none"}),{once:!0})}function u(){t.getProjects().forEach((e=>a(n(e.projectName,e.id))))}function p(e){const t=document.querySelector(".main-page").style.display,o=e.target.value;"none"!==t?document.querySelectorAll(".main-page_project").forEach((e=>{e.querySelector(".project_title").textContent.includes(o)?e.style="display: flex":e.style="display: none"})):document.querySelectorAll(".task").forEach((e=>{e.querySelector(".task_title").textContent.includes(o)?e.style="display: flex":e.style="display: none"}))}!function(){const e=document.querySelector(".burger-icon"),t=document.querySelector(".mobile-menu-window");e.addEventListener("click",(()=>{t.classList.toggle("mobile-menu-active")}))}(),function(){const c=document.querySelector(".remove-modal-window"),r=document.querySelector(".edit-modal-window"),s=r.querySelector(".edit-modal-close"),i=c.querySelector(".remove-modal-close"),m=document.querySelector(".main-page_add-project-btn"),u=document.querySelector(".main-page_add-project-modal"),p=u.querySelector(".add-modal-window_name-field"),y=u.querySelector(".create-modal-window_btn"),k=document.querySelector(".project-page_modal-window"),g=document.querySelector(".project-page_add-task-btn"),v=document.querySelector(".add-task-modal-close"),S=document.querySelector(".create-task-modal-window_btn"),f=document.querySelector(".edit-task-modal-close"),w=document.querySelector(".project-page_edit-modal-window");f.addEventListener("click",(()=>{w.style="display: none"})),s.addEventListener("click",(()=>r.style="display: none")),i.addEventListener("click",(()=>c.style="display: none")),v.addEventListener("click",(()=>{k.style="display:none"})),m.addEventListener("click",(()=>{u.style="display: block",y.addEventListener("click",(()=>{const o=p.value;p.value="";let c=new e(o);t.addProject(c),a(n(o,c.id)),u.style="display: none"}),{once:!0})})),g.addEventListener("click",(()=>{k.style="display: block",S.addEventListener("click",(e=>{const n=e.target.parentElement.parentElement.parentElement.parentElement.querySelector(".project-id").textContent,a=e.target.parentElement.parentElement,c=a.querySelector(".add-task-modal-window_name-field"),r=a.querySelector(".add-task-modal-window_task-description-input"),s=a.querySelector(".add-task-modal_date-input"),i=a.querySelectorAll('input[name="priority-element"]');let m;i.forEach((e=>{e.checked&&(m=e.value)}));const u=c.value,p=r.value,y=s.value,g=new o(u,p,y,m,n),v=t.getTasks(n);v.push(g),t.updateTasksArray(n,v,"add"),c.value="",r.value="",s.value="",i.forEach((e=>e.checked=!1)),k.style="display: none",d(l(u,p,y,m,g.taskId))}),{once:!0})})),window.addEventListener("click",(e=>{"main-page_edit-project-modal-window edit-modal-window modal-window"===e.target.className&&(r.style="display: none")})),window.addEventListener("click",(e=>{"main-page_remove-project-modal-window remove-modal-window modal-window"===e.target.className&&(c.style="display: none")})),window.addEventListener("click",(e=>{"main-page_add-project-modal modal-window"===e.target.className&&(u.style="display: none")})),window.addEventListener("click",(e=>{"project-page_modal-window modal-window"===e.target.className&&(k.style="display: none")})),window.addEventListener("click",(e=>{"project-page_edit-modal-window modal-window"===e.target.className&&(w.style="display: none")}))}(),u(),function(){const e=document.querySelector(".search-input"),t=document.querySelector(".mobile-menu-window");e.addEventListener("keyup",p),t.addEventListener("keyup",p)}(),function(){const e=document.querySelector(".logo"),t=document.querySelector(".projects-btn"),o=document.querySelector(".main-page"),n=document.querySelector(".project-page"),a=document.querySelector(".search-input");let c=document.querySelectorAll(".project");e.addEventListener("click",(()=>{o.style="display:block",n.style="display:none",a.placeholder="Search",c=document.querySelectorAll(".project"),c.forEach((e=>e.remove())),u()})),t.addEventListener("click",(()=>{o.style="display:block",n.style="display:none",a.placeholder="Search",c=document.querySelectorAll(".project"),c.forEach((e=>e.remove())),u()}))}()})();